# GL-E2EATP
GL-E2EATP: improving protein-ATP binding residue prediction using global and local embedding of protein language model

Identification of ATP-binding residues in proteins is of paramount importance for elucidating the mechanisms underlying protein functions and advancing drug discovery efforts. Numerous computational approaches have been developed to predict ATP-binding sites; however, the predictive performance of these methods remains suboptimal, primarily due to limitations in the quality of feature representation. In this study, we introduce GL-E2EATP, an end-to-end deep learning model designed to further enhance the prediction of ATP-binding residues by extracting both global and local embeddings from protein language model generated by protein sequences. Specifically, we leverage a pre-trained deep learning-based protein language model, ESM2, to autonomously generate high-latent discriminative representations of protein sequences that are functionally relevant. Building upon ESM2, two different neural network modules, i.e., convolutional layers and multi-head attention layers, are employed to separately extract global information for whole protein sequences and local information for the potential ATP-binding residues. Empirical evaluations conducted on two independent test datasets reveal that GL-E2EATP outperforms most state-of-the-art prediction methods, achieving superior Matthews correlation coefficient (MCC), area under the ROC curve (AUC), and area under the Precision-Recall curve (AUCPR) metrics. Comprehensive data analyses indicate that the principal advantage of GL-E2EATP stems from its utilization of the pre-trained protein language model and the combination of the global and local information. The standalone package for GL-E2EATP is downloadable at https://github.com/jun-csbio/gl-e2eatp/ for academic use.

## Pre-requisite:
    - Python3, Java, Anaconda3
    - Linux system

## Installation:

* Download this repository at https://github.com/jun-csbio/gl-e2eatp.git. Then, uncompress it and run the following command lines on Linux System.

~~~
  $ chmod 777 ./run.sh
  $ ./run.sh
~~~

* If the package cannot work correctly on your computational cluster, you should install the dependencies via running the following commands:

~~~
  $ pip install -r requirements.txt
~~~

## Run example
~~~
  $ python predict.py -sf example/results/ -seq_fa example/seq.fa
~~~

## Result

* The prediction result file (e.g., "3J8YK.pred") of each protein (e.g., 3J8YK) in your input fasta file (-seq_fa) could be found in the folder which you input as "-sf".
* There are four columns in each prediction result file. The 1st column is the residue index. The 2nd column is the residue type. The 3rd column is the predicted probablity of the corresponding residue belonging to the class of ATP-binding residues. The 4th column is the prediction result ('B' and 'N' mean the predicted ATP-binding and non-ATP-binding residue, respectively). For example:

~~~
Index    AA    Prob.
    0     A    0.001
    1     E    0.000
    2     S    0.007
    3     N    0.001
    4     I    0.000
    5     K    0.000
    6     V    0.000
    7     M    0.003
    8     C    0.000
    9     R    0.984
   10     F    0.000
   11     R    0.993
   12     P    0.990
   13     L    0.001
   14     N    0.001
   15     E    0.000
   16     S    0.005
   17     E    0.000
   18     V    0.000
   19     N    0.001
~~~

## Update History:

- First release          2025-03-31

## Tips

* <b>This package is only free for academic use</b>. If you have any question, please email Jun Hu: hj@ism.cams.cn

## References
[1] Bing Rao, Jie Bai and Jun Hu. GL-E2EATP: improving protein-ATP binding residue prediction using global and local embedding of protein language model. 2025, submit.
