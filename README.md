# GL-E2EATP
GL-E2EATP: improving protein-ATP binding residue prediction using global and local embedding of protein language model

Identification of ATP-binding residues in proteins is of paramount importance for elucidating the mechanisms underlying protein functions and advancing drug discovery efforts. Numerous computational approaches have been developed to predict ATP-binding sites; however, the predictive performance of these methods remains suboptimal, primarily due to limitations in the quality of feature representation. In this study, we introduce GL-E2EATP, an end-to-end deep learning model designed to further enhance the prediction of ATP-binding residues by extracting both global and local embeddings from protein language model generated by protein sequences. Specifically, we leverage a pre-trained deep learning-based protein language model, ESM2, to autonomously generate high-latent discriminative representations of protein sequences that are functionally relevant. Building upon ESM2, two different neural network modules, i.e., convolutional layers and multi-head attention layers, are employed to separately extract global information for whole protein sequences and local information for the potential ATP-binding residues. Empirical evaluations conducted on two independent test datasets reveal that GL-E2EATP outperforms most state-of-the-art prediction methods, achieving superior Matthews correlation coefficient (MCC), area under the ROC curve (AUC), and area under the Precision-Recall curve (AUCPR) metrics. Comprehensive data analyses indicate that the principal advantage of GL-E2EATP stems from its utilization of the pre-trained protein language model and the combination of the global and local information. The standalone package for GL-E2EATP is downloadable at https://github.com/jun-csbio/gl-e2eatp/ for academic use.

## Pre-requisite:
    - Python 3.10, Java, Anaconda3
    - Linux system

## Installation:

* Download this repository at https://github.com/jun-csbio/gl-e2eatp.git. Then, uncompress it and run the following command lines on Linux System.

~~~
  $ chmod 777 ./install.sh
  $ ./install.sh
~~~

* If the package cannot work correctly on your computational cluster, you should install the dependencies via running the following commands:

~~~
  $ conda env create -f conda.yaml
~~~

## Run example
~~~
  $ python predict.py -sf example/results/ -seq_fa example/seq.fa
~~~

## Result

* The prediction result file (e.g., "3J8YK.pred") of each protein (e.g., 3J8YK) in your input fasta file (-seq_fa) could be found in the folder which you input as "-sf".
* There are three columns in each prediction result file. The 1st column is the residue index. The 2nd column is the residue type. The 3rd column is the predicted probablity of the corresponding residue belonging to the class of ATP-binding residues. For example:

~~~
Index    AA    Prob.    State
    0     M    0.00001363
    1     G    0.00000268
    2     S    0.00001951
    3     R    0.00014070
    4     V    0.00003923
    5     V    0.00006795
    6     I    0.00009141
    7     L    0.00016943
    8     F    0.03583513
    9     T    0.00035952
   10     D    0.96167221
   11     I    0.98409954
   12     E    0.99114924
   13     E    0.98829891
   14     S    0.97349514
   15     T    0.96523270
   16     A    0.00146968
   17     L    0.00024427
   18     N    0.00119447
   19     E    0.00041184
   20     R    0.00037127
   21     I    0.00092568
   22     G    0.00079243
   23     D    0.01414010
   24     R    0.00164558
   25     A    0.00008177
   26     W    0.00263824
   27     V    0.00299289
   28     K    0.00018157
   29     L    0.00128787
   30     I    0.01475696
~~~

## Update History:

- First release          2025-03-31

## Tips

* <b>This package is only free for academic use</b>. If you have any question, please email Jun Hu: hj@ism.cams.cn

## References
[1] Bing Rao, Jie Bai and Jun Hu. GL-E2EATP: improving protein-ATP binding residue prediction using global and local embedding of protein language model. 2025, submit.
